---
title: "numerical_experimentations"
author: "pieter"
date: '2022-03-13'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r install}
remotes::install_github("oezgesahin/vineclust")
library(vineclust)
```

Simulate data

```{r simulate_data}
# Simulation setup given in Section 5.2 of the paper at https://arxiv.org/pdf/2102.03257.pdf
dims <- 3
obs <- c(500,500) 
RVMs <- list()
M1<-matrix(c(1,3,2,0,3,2,0,0,2),dims,dims)
F1<-matrix(c(0,3,4,0,0,14,0,0,0),dims,dims)
cop1<-matrix(c(0,0.8571429,2.5,0,0,5,0,0,0),dims,dims)

RVMs[[1]] <- VineCopula::RVineMatrix(Matrix=M1,
                        family=F1,
                        par=cop1,
                        par2=matrix(sample(0, dims*dims, replace=TRUE),dims,dims)) 
M2<-matrix(c(1,3,2,0,3,2,0,0,2), dims,dims)
F2<-matrix(c(0,6,5,0,0,13,0,0,0), dims,dims)
cop2<-matrix(c(0,1.443813,11.43621,0,0,2,0,0,0),dims,dims)
        

RVMs[[2]] <- VineCopula::RVineMatrix(Matrix=M2,
                        family=F2,
                        par=cop2,
                        par2=matrix(sample(0, dims*dims, replace=TRUE),dims,dims))
margin <- matrix(c('Skew Student-t', 'Normal', 'Logistic', 'Normal', 'Skew Student-t', 'Logistic'), 3, 2) 

margin_pars <- array(0, dim=c(4, 3, 2))
margin_pars[,1,1] <- c(1, 2, 7, 1.5)
margin_pars[,1,2] <- c(1.5, 0.4, 0, 0)
margin_pars[,2,1] <- c(1, 0.2, 0, 0)
margin_pars[,2,2] <- c(1, 2, 7, 1.5)
margin_pars[,3,1] <- c(0, 1, 0, 0)
margin_pars[,3,2] <- c(0.5, 0.5, 2.5, 0)
x_data <- rvcmm(dims, obs, margin, margin_pars, RVMs)
plot(x_data[,1:3])
```

```{r initial_clustering}
library(Stats230VineCopulaClustering)
mix<-c(0.5,0.5)
test_vineclust(x_data, margin_pars, M1, M2, F1, F2, cop1, cop2, mix)


```
